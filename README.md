# conveyor

Бэкенд-приложение с микросервисной архитектурой - прототип небольшого банка

## Логика работы системы:

1. Пользователь отправляет заявку на кредит. <br>
2. МС application осуществляет прескоринг заявки и если прескоринг проходит, то заявка сохраняется в МС deal и отправляется в МС conveyor. <br>
3. Conveyor возвращает через МС deal пользователю 4 предложения (сущность "LoanOffer") по кредиту с разными условиями или отказ. <br>
4. Пользователь выбирает одно из предложений, отправляется запрос в МС application, а оттуда в МС deal, где заявка на кредит и сам кредит сохраняются в базу. <br>
5. МС deal отправляет клиенту письмо с просьбой завершить регистрацию  <br>
6. Клиент отправляет запрос в МС deal со всеми своими полными данными о работодателе и прописке. Происходит скоринг данных в conveyor, conveyor рассчитывает все данные по кредиту (ПСК, график платежей и тд), МС deal сохраняет обновленную заявку и сущность кредит сделанную на основе CreditDTO полученного из conveyor со статусом CALCULATED в БД. <br>
7. После валидации МС deal отправляет письмо на почту клиенту с одобрением или отказом. Если кредит одобрен, то в письме приходит запрос на формирование документов<br>
8. Клиент отправляет запрос на формирование документов в МС deal, МС deal отправляет клиенту на почту документы для подписания.<br>
9. Клиент может отказаться от условий или согласиться. Если согласился - МС deal на почту отправляет код и ссылку на подписание документов, куда клиент должен отправить полученный код в МС deal.<br>
10. Если полученный код совпадает с отправленным, МС deal выдает кредит (меняет статус сущности "Кредит" на ISSUED, а статус заявки на CREDIT_ISSUED)<br>

## Архитектура:

![image](https://github.com/AlekseyObukhov/conveyor/assets/133809437/3a31379f-3c79-4391-b2a9-02a46a4938ae)

## Стэк:

* Java
* Spring Boot
* Docker
* Apache Kafka
* JPA
* Swagger
* JUnit, Mockito

## Запуск docker-compose

`docker-compose up -d`<br>

Перед запуском docker-compose необходимо собрать микросервисы и упаковать их в jar файлы <br>

## Документация API
Взаимодействие с системой осуществляется через МС-Gateway <br>
API задокументировано с помощью Swagger: http://localhost:8090/swagger-ui/index.html <br>
